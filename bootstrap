"""
é˜¿é‡Œäº‘å‡½æ•°è®¡ç®—è‡ªå®šä¹‰è¿è¡Œæ—¶ Bootstrap å¯åŠ¨æ–‡ä»¶
ç¬¦åˆ FC Custom Runtime è§„èŒƒ
"""
import os
import sys
import subprocess
import signal

# æ·»åŠ å½“å‰ç›®å½•åˆ° Python è·¯å¾„
sys.path.insert(0, os.path.dirname(__file__))

def start_server():
    """å¯åŠ¨ MCP æœåŠ¡å™¨"""
    print("="*70, flush=True)
    print("ğŸš€ é˜¿é‡Œäº‘å‡½æ•°è®¡ç®— - Bootstrap å¯åŠ¨", flush=True)
    print("="*70, flush=True)
    print(f"âœ“ å·¥ä½œç›®å½•: {os.getcwd()}", flush=True)
    print(f"âœ“ Pythonç‰ˆæœ¬: {sys.version}", flush=True)
    print(f"âœ“ FC_SERVER_PORT: {os.environ.get('FC_SERVER_PORT', 'æœªè®¾ç½®')}", flush=True)
    print(f"âœ“ FC_RUNTIME: {os.environ.get('FC_RUNTIME', 'æœªè®¾ç½®')}", flush=True)
    print("="*70, flush=True)
    
    # å¯åŠ¨ MCP æœåŠ¡å™¨è¿›ç¨‹
    cmd = [sys.executable, "mcp_server.py"]
    print(f"âœ“ æ‰§è¡Œå‘½ä»¤: {' '.join(cmd)}", flush=True)
    
    # ä½¿ç”¨ exec æ›¿æ¢å½“å‰è¿›ç¨‹ï¼Œè¿™æ ·ä¿¡å·å¤„ç†ä¼šæ­£ç¡®ä¼ é€’
    os.execvp(sys.executable, cmd)


if __name__ == "__main__":
    start_server()
